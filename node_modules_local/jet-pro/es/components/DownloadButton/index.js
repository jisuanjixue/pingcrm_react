// import { useSafeState } from 'ahooks';
// import { Button, message } from 'antd';
// import type { ButtonProps } from 'antd/es/button';
// import React, { useRef } from 'react';
// // import type { RequestResponse } from 'umi-request';
// import { v4 as UUId } from 'uuid';
// import { hasKey } from '../../utils/objectUtils';

// export interface IProps extends ButtonProps {
//   /**
//    * 【jet-pro】下载到本地保存的文件名
//    */
//   fileName?: string;
//   /**
//    * 【jet-pro】下载请求
//    */
//   request: () => Promise<Blob | Response<Blob>> | undefined;
// }
// /**
//  * 文件下载按钮
//  */
// const DownloadButton = ({
//   children,
//   request,
//   fileName: propsFileName = 'download',
//   ...btnProps
// }: IProps) => {
//   const id = useRef<string>(UUId()).current;
//   const [loading, setLoading] = useSafeState<boolean>();

//   return (
//     <Button
//       {...{
//         ...btnProps,
//         loading,
//         onClick: async () => {
//           if (!request) return;

//           setLoading(true);
//           try {
//             let res = await request();
//             if (!res) {
//               setLoading(false);
//               message.error('下载错误');
//               return;
//             }

//             let blobData: Blob;
//             let fileName = propsFileName;

//             if (hasKey(res, 'response')) {
//               res = res as RequestResponse<Blob>;
//               blobData = res.data;
//               const disposition = res.response.headers.get(
//                 'content-disposition',
//               );

//               const item = disposition
//                 ?.split(';')
//                 ?.find((i: string) => i.includes('filename*='));
//               fileName = decodeURIComponent(
//                 item?.substring(item.lastIndexOf("'") + 1) || '',
//               );
//             } else {
//               blobData = res as Blob;
//             }

//             setLoading(false);
//             let link = document.getElementById(id) as HTMLAnchorElement;
//             if (!link) {
//               link = document.createElement('a');
//               link.style.display = 'none';
//               link.setAttribute('id', id);
//               link.setAttribute('download', fileName);
//               document.body.appendChild(link);
//             }
//             link.href = window.URL.createObjectURL(blobData);
//             link.click();
//           } catch (e: any) {
//             setLoading(false);
//             message.error(e.message || '出错了');
//           }
//         },
//       }}
//     >
//       {children}
//     </Button>
//   );
// };

// export default DownloadButton;
