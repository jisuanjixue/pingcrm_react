import dayjs, { isDayjs } from 'dayjs';
/**
 * 格式化日期时间
 * @param value 支持Dayjs|Date|string|undefined|null类型的值输入
 * @param format 格式化字符串
 * @returns
 */
export var formatDateTime = function formatDateTime(value, format) {
  if (!value) return '';
  var formatStr = format;
  if (!formatStr) formatStr = 'YYYY-MM-DD HH:mm';
  var date = isDayjs(value) ? value : dayjs(value);
  return date.format(formatStr);
};

/**
 * 格式化为时间字符串
 * @param value
 * @returns
 */
export var formatTime = function formatTime(value) {
  return formatDateTime(value, 'HH:mm:ss');
};

/**
 * 格式化为日期字符串
 * @param value
 * @returns
 */
export var formatDate = function formatDate(value) {
  return formatDateTime(value, 'YYYY-MM-DD');
};

/**
 * 转换成Moment
 * @param value 如果是Moment类型则直接返回
 * @returns Moment | undefined | null
 */
export var convertToMoment = function convertToMoment(value) {
  if (!value) return undefined;
  if (isDayjs(value)) return value;
  var valMoment;
  if (typeof value === 'string') {
    // 判断是否是TimeSpan
    if (value.indexOf('-') === -1) {
      valMoment = dayjs(''.concat(formatDate(dayjs()), ' ').concat(value));
    }
  }
  if (!valMoment) valMoment = dayjs(value);
  if (!valMoment.isValid()) return undefined;
  return valMoment;
};
