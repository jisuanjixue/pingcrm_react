import type { ButtonProps, DrawerProps, FormInstance, FormProps, ModalProps } from 'antd';
import type { MutableRefObject, ReactNode } from 'react';

type excludeProps = 'visible' | 'title' | 'width' | 'footer' | 'onClose';

type TModalProps = Omit<DrawerProps, excludeProps>;
type TDrawerProps = Omit<ModalProps, excludeProps>;

type TFooterButtonProps = ButtonProps & { text?: ReactNode };

export interface IFormProps<TDetailView, TSaveView = TDetailView> extends FormProps {
  /** 【jet-pro】表单初始化数据，因为表单只接收一次初始花数据，把数据备注好再返回 */
  initDetail?: () => Promise<TDetailView | undefined>;
  /** 【jet-pro】form实例，默认使用内置form实例
   * @default undefined
   */
  form?: FormInstance<TSaveView>;

  children?: ReactNode;
}

interface IDrawerOrModalFormProps<TDetailView, TSaveView = TDetailView>
  extends Omit<IFormProps<TDetailView, TSaveView>, 'form' | 'title'> {
  /** 【jet-pro】引用form实例 */
  refForm?: MutableRefObject<FormInstance<TSaveView> | undefined>;
  /** 【jet-pro】是否显示 */
  visible?: boolean;
  /** 【jet-pro】标题 */
  title?: ReactNode;
  /** 【jet-pro】宽度 */
  width?: string | number;

  /** 【jet-pro】footer配置 */
  footerProps?: {
    /** 【jet-pro】取消按钮 */
    cancelProps?: TFooterButtonProps;
    /** 【jet-pro】重置按钮 */
    resetProps?: TFooterButtonProps;
    /** 【jet-pro】提交按钮 */
    submitProps?: TFooterButtonProps;
  };
  /** 【jet-pro】重绘footer */
  footer?: ReactNode;
  /** 【jet-pro】footer额外元素 */
  footerExtra?: ReactNode;
  /** 【jet-pro】返回Promise<boolean>，true则收起抽屉/关闭对话框 */
  onSubmit?: (data: TSaveView) => Promise<boolean>;

  /** 【jet-pro】关闭 */
  onClose?: (e: React.MouseEvent<HTMLElement, any>) => void;
}
export interface IDrawerFormProps<TDetailView, TSaveView = TDetailView>
  extends IDrawerOrModalFormProps<TDetailView, TSaveView> {
  /** 【jet-pro】drawer配置 */
  drawerProps?: Omit<DrawerProps, excludeProps>;
}

export interface IModalFormProps<TDetailView, TSaveView = TDetailView>
  extends IDrawerOrModalFormProps<TDetailView, TSaveView> {
  /** 【jet-pro】modal配置 */
  modalProps?: Omit<ModalProps, excludeProps>;
}

export interface IEditFormProps<TDetailView, TSaveView = TDetailView>
  extends IFormProps<TDetailView, TSaveView> {
  /** 【jet-pro】引用form实例 */
  refForm?: MutableRefObject<FormInstance<TSaveView> | undefined>;
  /** 【jet-pro】footer配置 */
  footerProps?: {
    /** 【jet-pro】取消按钮 */
    cancelProps?: TFooterButtonProps;
    /** 【jet-pro】重置按钮 */
    resetProps?: TFooterButtonProps;
    /** 【jet-pro】提交按钮 */
    submitProps?: TFooterButtonProps;
  };
  /** 【jet-pro】重绘footer */
  footer?: ReactNode | boolean;
  /** 【jet-pro】footer额外元素 */
  footerExtra?: ReactNode;

  /** 【jet-pro】取消 */
  onCancel?: () => void;

  /** 【jet-pro】提交表单 */
  onSubmit?: (value: TSaveView) => Promise<void>;
}
